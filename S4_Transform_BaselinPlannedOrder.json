{"name":"S4_Transform_BaselinPlannedOrder","appVersion":"70612f2c-040f-11ee-8d1c-5e154bae3276","description":"Supply - BaselinePlannedOrder Transform and Load.","change":{"author":"cdap","creationTimeMillis":1686017485559,"latest":true},"configuration":"{\"resources\":{\"memoryMB\":2048.0,\"virtualCores\":1.0},\"driverResources\":{\"memoryMB\":2048.0,\"virtualCores\":1.0},\"connections\":[{\"from\":\"PLAF source\",\"to\":\"Baseline Planned Order transform\"},{\"from\":\"Baseline Planned Order transform\",\"to\":\"Baseline Planned Order Repartitioner\"},{\"from\":\"Baseline Planned Order Repartitioner\",\"to\":\"Baseline Planned Order\"},{\"from\":\"Baseline Planned Order\",\"to\":\"Post Processing\"},{\"from\":\"Check RunTransformBaselinePlannedOrder\",\"to\":\"PLAF source\",\"condition\":true}],\"comments\":[],\"postActions\":[],\"properties\":{},\"processTimingEnabled\":true,\"stageLoggingEnabled\":false,\"stages\":[{\"name\":\"PLAF source\",\"plugin\":{\"name\":\"GCSFile\",\"type\":\"batchsource\",\"label\":\"PLAF source\",\"artifact\":{\"name\":\"google-cloud\",\"version\":\"0.22.1-SNAPSHOT\",\"scope\":\"SYSTEM\"},\"properties\":{\"useConnection\":\"false\",\"project\":\"auto-detect\",\"serviceAccountType\":\"filePath\",\"serviceFilePath\":\"auto-detect\",\"referenceName\":\"Supply_PLAF\",\"path\":\"${extracted-data-bucket}/${source}.${timestamp}/PLAF.tab\",\"format\":\"tsv\",\"sampleSize\":\"100\",\"filenameOnly\":\"false\",\"recursive\":\"false\",\"ignoreNonExistingFolders\":\"false\",\"encrypted\":\"false\",\"fileEncoding\":\"UTF-8\",\"schema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"MANDT\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PLNUM\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"AUFFX\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"BEDID\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"GSMNG\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"KDAUF\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"KDPOS\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"LGORT\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"LVSCH\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"MATNR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"MEINS\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PAART\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PEDTR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PLWRK\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PSTTR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PWWRK\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"RSNUM\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"SERNR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"SOBES\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"WEBAZ\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]}]}\",\"enableQuotedValues\":\"false\",\"skipHeader\":\"true\",\"maxSplitSize\":\"${GCS_SOURCE_MAXIMUM_SPLIT_SIZE}\"}},\"outputSchema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"MANDT\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PLNUM\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"AUFFX\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"BEDID\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"GSMNG\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"KDAUF\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"KDPOS\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"LGORT\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"LVSCH\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"MATNR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"MEINS\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PAART\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PEDTR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PLWRK\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PSTTR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PWWRK\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"RSNUM\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"SERNR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"SOBES\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"WEBAZ\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]}]}\",\"id\":\"PLAF-source\"},{\"name\":\"Baseline Planned Order transform\",\"plugin\":{\"name\":\"Wrangler\",\"type\":\"transform\",\"label\":\"Baseline Planned Order transform\",\"artifact\":{\"name\":\"wrangler-transform\",\"version\":\"4.9.1-SNAPSHOT\",\"scope\":\"SYSTEM\"},\"properties\":{\"field\":\"*\",\"precondition\":\"AUFFX \\u003d\\u003d \\u0027X\\u0027\",\"directives\":\"find-and-replace :MATNR s/^0+//g\\r\\nset column PartName MATNR\\r\\nset column PartSiteValue PLWRK\\r\\nset column ModelValue \\u0027None\\u0027\\r\\nset column PoolValue \\u0027UnPooled\\u0027\\r\\nset column StartDate PSTTR\\r\\nset column DueDate PEDTR\\r\\nset column Quantity GSMNG\\r\\n\\r\\nset-type Quantity decimal\\r\\nset-column Quantity (Quantity !~ null ? Quantity.setScale(4,4) : null)\\r\\n\\r\\n\",\"on-error\":\"fail-pipeline\",\"schema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"PartName\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PartSiteValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"ModelValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PoolValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"StartDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"DueDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"Quantity\\\",\\\"type\\\":[{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":32,\\\"scale\\\":4},\\\"null\\\"]}]}\"}},\"information\":{\"comments\":{\"list\":[{\"content\":\"\\n---\\nRemove leading zeros from MATNR \\n---\\n\\nfind-and-replace :MATNR s/^0+//g\\n\\n---\\nRename columns as per final output and assign default values for few columns\\n---\\n\\nset column PartName MATNR\\nset column PartSiteValue PLWRK\\nset column ModelValue \\u0027None\\u0027\\nset column PoolValue \\u0027UnPooled\\u0027\\nset column StartDate PSTTR\\nset column DueDate PEDTR\\nset column Quantity GSMNG\\n\\nConvert to Decimal\\n--\\n\\nset-type Quantity decimal\\nset-column Quantity (Quantity !~ null ? Quantity.setScale(4,4) : null)\\n\\n\",\"createDate\":1.677818846495E12}]}},\"outputSchema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"PartName\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PartSiteValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"ModelValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PoolValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"StartDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"DueDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"Quantity\\\",\\\"type\\\":[{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":32,\\\"scale\\\":4},\\\"null\\\"]}]}\",\"inputSchema\":[{\"name\":\"PLAF source\",\"schema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"MANDT\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PLNUM\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"AUFFX\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"BEDID\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"GSMNG\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"KDAUF\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"KDPOS\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"LGORT\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"LVSCH\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"MATNR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"MEINS\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PAART\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PEDTR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PLWRK\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PSTTR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PWWRK\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"RSNUM\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]},{\\\"name\\\":\\\"SERNR\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"SOBES\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"WEBAZ\\\",\\\"type\\\":[\\\"double\\\",\\\"null\\\"]}]}\"}],\"id\":\"Baseline-Planned-Order-transform\"},{\"name\":\"Baseline Planned Order Repartitioner\",\"plugin\":{\"name\":\"Repartitioner\",\"type\":\"sparkcompute\",\"label\":\"Baseline Planned Order Repartitioner\",\"artifact\":{\"name\":\"repartitioner\",\"version\":\"1.2.0\",\"scope\":\"USER\"},\"properties\":{\"partitions\":\"${REPARTITION_NUMBER_FOR_SINK}\",\"shuffle\":\"${REPARTITION_SHUFFLE_DATA}\"}},\"outputSchema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"PartName\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PartSiteValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"ModelValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PoolValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"StartDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"DueDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"Quantity\\\",\\\"type\\\":[{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":32,\\\"scale\\\":4},\\\"null\\\"]}]}\",\"inputSchema\":[{\"name\":\"Baseline Planned Order transform\",\"schema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"PartName\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PartSiteValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"ModelValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PoolValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"StartDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"DueDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"Quantity\\\",\\\"type\\\":[{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":32,\\\"scale\\\":4},\\\"null\\\"]}]}\"}],\"id\":\"Baseline-Planned-Order-Repartitioner\"},{\"name\":\"Baseline Planned Order\",\"plugin\":{\"name\":\"GCS\",\"type\":\"batchsink\",\"label\":\"Baseline Planned Order\",\"artifact\":{\"name\":\"google-cloud\",\"version\":\"0.22.1-SNAPSHOT\",\"scope\":\"SYSTEM\"},\"properties\":{\"useConnection\":\"false\",\"project\":\"auto-detect\",\"serviceAccountType\":\"filePath\",\"serviceFilePath\":\"auto-detect\",\"referenceName\":\"BaselinePlannedOrder\",\"path\":\"${transformed-data-bucket}/${source}.${timestamp}/BaselinePlannedOrder\",\"format\":\"tsv\",\"location\":\"us\",\"contentType\":\"application/octet-stream\",\"schema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"PartName\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PartSiteValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"ModelValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PoolValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"StartDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"DueDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"Quantity\\\",\\\"type\\\":[{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":32,\\\"scale\\\":4},\\\"null\\\"]}]}\",\"writeHeader\":\"false\",\"outputFileNameBase\":\"BaselinePlannedOrder\"}},\"outputSchema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"PartName\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PartSiteValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"ModelValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PoolValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"StartDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"DueDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"Quantity\\\",\\\"type\\\":[{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":32,\\\"scale\\\":4},\\\"null\\\"]}]}\",\"inputSchema\":[{\"name\":\"Baseline Planned Order Repartitioner\",\"schema\":\"{\\\"name\\\":\\\"etlSchemaBody\\\",\\\"type\\\":\\\"record\\\",\\\"fields\\\":[{\\\"name\\\":\\\"PartName\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PartSiteValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"ModelValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"PoolValue\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"StartDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"DueDate\\\",\\\"type\\\":[\\\"string\\\",\\\"null\\\"]},{\\\"name\\\":\\\"Quantity\\\",\\\"type\\\":[{\\\"type\\\":\\\"bytes\\\",\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":32,\\\"scale\\\":4},\\\"null\\\"]}]}\"}],\"id\":\"Baseline-Planned-Order\"},{\"name\":\"Post Processing\",\"plugin\":{\"name\":\"PySparkProgram\",\"type\":\"sparkprogram\",\"label\":\"Post Processing\",\"artifact\":{\"name\":\"dynamic-spark\",\"version\":\"2.2.3\",\"scope\":\"USER\"},\"properties\":{\"pythonCode\":\"from pyspark import *\\nfrom pyspark.sql import *\\nfrom cdap.pyspark import SparkExecutionContext\\nimport google.auth\\nfrom google.cloud import storage\\nimport traceback\\nimport re\\nimport logging\\n\\nsec \\u003d SparkExecutionContext()\\nsc \\u003d SparkContext()\\n\\n# reading the required properties from runtime arguments\\nproject_id \\u003d \\\"${project-id}\\\"\\ntransformed_data_bucket_name \\u003d \\\"${transformed-data-bucket}\\\" if \\\"gs://\\\" not in \\\"${transformed-data-bucket}\\\" else \\\"${transformed-data-bucket}\\\".split(\\\"gs://\\\")[1]\\nsource \\u003d \\\"${source}\\\"\\ntimestamp \\u003d \\\"${timestamp}\\\"\\ntransformed_data_dir \\u003d source + \\\".\\\" + timestamp\\ntarget_files \\u003d \\\"${transformed-files}\\\"\\n\\nstorage_client \\u003d storage.Client()\\ntransformed_data_bucket \\u003d storage_client.get_bucket(transformed_data_bucket_name)\\n\\ndef list_blobs_with_prefix(bucket_name, prefix, delimiter):\\n  blobs \\u003d storage_client.list_blobs(transformed_data_bucket_name, prefix\\u003dprefix, delimiter\\u003ddelimiter)\\n  return blobs\\n\\ndef rename_target_file(file_name):\\n  file_prefix \\u003d transformed_data_dir + \\\"/\\\" + file_name + \\\"/\\\"\\n  blobs \\u003d list_blobs_with_prefix(transformed_data_bucket_name,file_prefix,\\u0027/\\u0027)\\n  for blob in blobs:\\n    blob_name \\u003d blob.name\\n    if file_name in blob_name:\\n      blob_size \\u003d f\\\"{blob.size} bytes\\\"\\n    \\n      if blob_size \\u003d\\u003d \\\"0 bytes\\\":\\n        blob.delete()\\n      else:\\n        pattern \\u003d \\\"-r-\\\\d{5}\\\"\\n        result \\u003d re.findall(pattern, blob_name)\\n        if result:\\n          updated_blob_name \\u003d blob_name.split(\\\"/\\\")[-1].replace(\\\"-r-\\\", \\\".\\\") + \\\".tab\\\" #renaming file name\\n          updated_blob_path \\u003d \\\"{}/{}\\\".format(transformed_data_dir, updated_blob_name)\\n          transformed_data_bucket.rename_blob(blob, new_name\\u003dupdated_blob_path)\\n\\ndef rename_all_target_files():\\n  print(f\\\"--------------------List of Target Files: {target_files}--------------------\\\")\\n  files \\u003d target_files.split(\\u0027,\\u0027)\\n  for file in files:\\n    print(f\\\"--------------------Renaming Target File: {file}--------------------\\\")\\n    rename_target_file(file)\\n  \\n\\ntry:\\n    print(\\\"\\u003c\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003dPost processing execution STARTED\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003e\\\")\\n    rename_all_target_files()\\n    print(\\\"\\u003c\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003dPost processing execution COMPLETED\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003d\\u003e\\\")\\nexcept:\\n    logging.info(\\\"Into Exception\\\")\\n    exception_error_message \\u003d traceback.format_exc()\\n    logging.info(exception_error_message)\"}},\"outputSchema\":\"\",\"id\":\"Post-Processing\"},{\"name\":\"Check RunTransformBaselinePlannedOrder\",\"plugin\":{\"name\":\"Conditional\",\"type\":\"condition\",\"label\":\"Check RunTransformBaselinePlannedOrder\",\"artifact\":{\"name\":\"condition-plugins\",\"version\":\"1.12.1-SNAPSHOT\",\"scope\":\"SYSTEM\"},\"properties\":{\"expression\":\"${RunTransformBaselinePlannedOrder} \\u003d\\u003d \\u0027true\\u0027\"}},\"outputSchema\":\"\",\"inputSchema\":[],\"id\":\"Check-RunTransformBaselinePlannedOrder\"}],\"schedule\":\"0 1 */1 * *\",\"engine\":\"spark\",\"numOfRecordsPreview\":100.0,\"rangeRecordsPreview\":{\"min\":1.0,\"max\":\"5000\"},\"description\":\"Supply - BaselinePlannedOrder Transform and Load.\",\"maxConcurrentRuns\":1.0}","datasets":[],"programs":[{"type":"Spark","app":"S4_Transform_BaselinPlannedOrder","name":"phase-2","description":"Sources \u0027PLAF source\u0027 to sinks \u0027Baseline Planned Order\u0027."},{"type":"Spark","app":"S4_Transform_BaselinPlannedOrder","name":"phase-3","description":""},{"type":"Workflow","app":"S4_Transform_BaselinPlannedOrder","name":"DataPipelineWorkflow","description":"Data Pipeline Workflow"}],"plugins":[{"id":"Baseline Planned Order:tsv","name":"tsv","type":"validatingOutputFormat"},{"id":"Baseline Planned Order transform","name":"Wrangler","type":"transform"},{"id":"8f726935-314a-49f0-a778-5557f32a9665","name":"PySparkProgram","type":"sparkprogram"},{"id":"PLAF source","name":"GCSFile","type":"batchsource"},{"id":"Check RunTransformBaselinePlannedOrder","name":"Conditional","type":"condition"},{"id":"Post Processing","name":"PySparkProgram","type":"sparkprogram"},{"id":"PLAF source:tsv","name":"tsv","type":"validatingInputFormat"},{"id":"Baseline Planned Order","name":"GCS","type":"batchsink"},{"id":"Baseline Planned Order Repartitioner","name":"Repartitioner","type":"sparkcompute"}],"artifact":{"name":"cdap-data-pipeline","version":"6.9.1-SNAPSHOT","scope":"SYSTEM"}}